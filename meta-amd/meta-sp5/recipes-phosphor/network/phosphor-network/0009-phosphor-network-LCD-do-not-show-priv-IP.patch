From 71ffacb60b97bf52294b2b29259b25e5ddfde634 Mon Sep 17 00:00:00 2001
From: Mohsen Dolaty <mohsen.dolaty@amd.com>
Date: Tue, 15 Feb 2022 14:53:45 -0600
Subject: [PATCH 1/1] phosphor-network: LCD do not show priv IP

Avoid showing the BMC private IP (169.254.x.x)
in LCD

Signed-off-by: Mohsen Dolaty <mohsen.dolaty@amd.com>
---
 ipaddress.cpp | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/ipaddress.cpp b/ipaddress.cpp
index 365ceca..f6a5936 100644
--- a/ipaddress.cpp
+++ b/ipaddress.cpp
@@ -57,8 +57,8 @@ IPAddress::IPAddress(sdbusplus::bus::bus& bus, const char* objPath,
     IP::origin(origin);
     // LCD
     snprintf(ip, LCD_BUFF_SIZE, "%s", address().c_str());
-    // skip IPV6
-    if (strstr(ip,":") == 0) {
+    // skip IPV6 and private IP 169.254
+    if ((strstr(ip,":") == 0) && (strstr(ip,"169.254.") == 0)) {
         snprintf(ip, LCD_BUFF_SIZE, "IP: %s \n", address().c_str());
         writeLCD(ip);
     }
--
2.25.1
